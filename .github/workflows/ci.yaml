name: Continuous Integration

on:
  push:
    branches-ignore:
      - 'bot/*'

jobs:
  onboard:
    uses: ./.github/workflows/onboard.yaml

  setup:
    if: ${{ needs.onboard.outputs.should_skip != 'true' }}
    uses: ./.github/workflows/setup.yaml
    needs:
      - onboard
    with:
      workflow: ci.yaml

  lint:
    uses: ./.github/workflows/lint.yaml
    needs:
      - setup

  ut:
    uses: ./.github/workflows/ut.yaml
    needs:
      - setup

  e2e:
    uses: ./.github/workflows/e2e.yaml
    needs:
      - setup

  lighthouse:
    uses: ./.github/workflows/lighthouse.yaml
    needs:
      - setup
      - lint
      - ut
      - e2e

  storybook:
    uses: ./.github/workflows/storybook.yaml
    needs:
      - setup
      - lint
      - ut
      - e2e
